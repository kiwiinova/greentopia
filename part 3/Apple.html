<!DOCTYPE html>
<html lang="en">
<!--<head>-->
 <head>
   <meta charset = "UTF-8">
   <meta http-equiv = "X-UA-Compatible" content="IE-edge"> 
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <link href="https://fonts.googleapis.com/css?
  family=Poppins:700|Work+Sans&display=swap" rel="stylesheet"> 
  <!-- Stylesheet -->
  <script src = "https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>                
   <link rel="stylesheet" href="styleproducts.css">
   <link rel="stylesheet" href="imagepages.css">
   <link rel="stylesheet" href="../part 3/normalize.css">
    <link rel="stylesheet" href="../part 3/skeleton.css">
    <link rel="stylesheet" href="../part 3/custom.css">
   <link rel="stylesheet" href="../CSS/Page1.css"/>
   <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons"/>
   
	 
    <script>
        var cart = [];
        $(function () {
            if (localStorage.cart)
            {
                cart = JSON.parse(localStorage.cart);
                showCart();
            }
        });

        function addToCart() {
            var sum= 0.0;
            // $('#cart-content > tbody > tr').each(function() {
            // var $img1 = $('<img width="30px" height="30px" src="' + addTocart.data("image") + '"/>').css({"position":"fixed","z-index":"999"});
            // var img1 = $('#item-list').find('.course-image').attr('src');
            var img1 = $(this).data('image');
            var price1 = $('.price .u-pull-right').text().replace("$", "");
            var price = parseFloat(price1);
            var name = $('h4').text();
            var qty = $('.count').val();
            var amount = (qty*price);

            sum+=amount;
            

            $('#totalPrice').text('$'+ sum);
            
            

           

            // update qty if product is already present
            for (var i in cart) {
                if(cart[i].Name == name)
                {
                    cart[i].Quantity = qty;
                    showCart();
                    saveCart();
                    return;
                }
            }
            // create JavaScript Object
            var item = {Image: img1, Name: name, Price: price, Quantity: qty }; 
            cart.push(item);
            console.log(cart);return false;
            saveCart();
            showCart();
        }

        function deleteItem(index){
            cart.splice(index,1); // delete item at index
            console.log(index);
            showCart();
            saveCart();
        }

        function saveCart() {
            if ( window.localStorage)
            {
                localStorage.cart = JSON.stringify(cart);
            }
        }

        function showCart() {
            // if (cart.length == 0) {
            //     $("#cart-content").css("visibility", "hidden");
            //     return;
            // }

            $("#cart-content").css("visibility", "visible");
            $("#cart-content tbody").empty();
            for (var i in cart) {
                var item = cart[i];
                var row = "<tr><td><img src='"+ item.Image +"' >" + "</td><td>" + item.Name + "</td><td>" +
                             item.Quantity + "</td><td>" + item.Quantity * item.Price + " $" + "</td><td>"
                             + "<button onclick='deleteItem(" + i + ")'>X</button></td></tr>";
                $("#cart-content tbody").append(row);
                buttonActivator();
            }
            $("button").css({"border": "1px solid red", "border-radius": "50%", "padding": "5px 10px", "text-decoration": "none", "color": "red", "width": "30px", "height": "30px", "flex-direction" : "column", "justify-content" : "center" , "align-item" : "center", "cursor": "pointer"});
           
    }  
    let buttonActivator = () => {
     let removeButtons =  document.querySelectorAll(".remove")

removeButtons.forEach(el => {
     el.addEventListener("click", (e)=>{
          let row = e.target.parentNode.parentNode;
          document.querySelectorAll("table#cart-content tbody")[0].removeChild(row)
     })
})

}
/// For clearing the entire cart
document.querySelector("a#clear-cart").addEventListener("click", ()=>{
     let rows = document.querySelectorAll("table#cart-content tbody")[0].childNodes
     while(rows)
          document.querySelectorAll("table#cart-content tbody")[0].removeChild(rows[0])  
})

    </script>	 
   </head>
   <body>
   <header>
      <input type="checkbox" id="menu" />
      <label for="menu"><i class="material-icons">menu</i></label>

      <nav class ="navbar">
        <ul>
          <li><a href="index.html"><i class="fa fa-home fa-fw" aria-hidden="true"></i>&nbsp; Home</a></li>
          <li>
            <a href="#"><i class="fa fa-angle-double-down" aria-hidden="true"></i>&nbsp; Aisles</a>
            <ul>
              <li><a href="../part 2/FruitsAndVeggies.html" #fruitsveggies>Fruits and Veggies</a></li>
              <li><a href="../part 2/DairyAndEggs.html" #dairyeggs>Dairy and Eggs</a></li>
              <li><a href="../part 2/BreadsAndPasta.html" #breadspasta>Breads and Pasta</a></li>
              <li><a href="../part 2/MeatsAndFish.html" #meatsfish>Meat and Fish</a></li>
            </ul>
          </li>
          <li><a href="../HTML/P4.html"><i class="fa fa-opencart" aria-hidden="true"></i>&nbsp; Shopping Cart</a></li>
          <li><a href="../HTML/P5.html"><i class="fa fa-user-o" aria-hidden="true"></i>&nbsp; Login</a></li>
          
          
        <div class="navbar-right">                   
<!--               <h1><i class="fa-solid fa-basket-shopping"></i></h1> -->
               <ul>
                    <li class="submenu">
                        <img alt="image of a shopping cart" src="../Images/basket-icon-7.jpg" id="img-cart">
                            <div id="shopping-cart">
                                    <table id="cart-content" class="u-full-width">
                                        <thead>
                                            <tr>
                                                <th>Image</th>
                                                <th>Name</th>
                                                <th>Quantity</th>
                                                <th>Price</th>
                                                <th></th>
                                            </tr>
                                        </thead>
                                        <tbody></tbody>
                                    </table>

                                    <a href="#" id="clear-cart" class="button u-full-width">Clear Cart</a>
                                    Total price: <strong id="totalPrice">0 $</strong>
                            </div>
                    </li>
                </ul>                      
      </div>

          </ul>
      </nav>
    </header>
<center>   
<!--       <div class="product">
        <div class="product-img">
            <div class="zoom">
            <img src= "..\Images\Apples.jpg" alt="Apple" title="Product">
            </div>
         </div>
        <div class="product-info">
            <h3>Apples</h3>
            <div class="price">$10.77
            </div>
        </div>
       
		<h5>$<span id="price" data-product="apple">10.77</span></h5>
		<div class="user-input">
        	<div class="input-element">
            	<span class="input-group-text" id="quantity-text">Quantity:</span>
			</div>
            <input type="number" class="form-control" id="quantity" placeholder="1" min="1" max="40">  
		</div>
       
        <div class="main">
     <!--<div class="btn">
      <ul>
      <button class="minusBtn">-</button>
      <button class="mainBtn">ADD TO CART</button>
      <button class="plusBtn">+</button>
      </ul>
     </div>
-->
 </div>
 </div> -->
	
	
	<div id="item-list" class="container">
        <h1 id="heading" class="heading"></h1>
        <div class="row">
            <div class="four columns">
                <div class="card">
                    <img alt="image of an apple" src="..\Images\Apples.jpg" class="course-image u-full-width">
                    <div class="info-card" data-name="html" data-price="15">
                        <h4>Apples</h4>
                        <p>Juan Pedro</p>
                       
                        <p class="price">$200  <span class="u-pull-right ">$15</span></p>
                        <input type = "number" class="count" value="1" />
                        <a href="#" class="u-full-width button-primary button input add-to-cart"  data-id="1" data-image="C:\Users\Shamma\Desktop\Concordia\winter\SOEN 287\assignment 1\images\Apples.jpg" onclick="addToCart(this)">Add to Cart</a>
                    </div>
                </div> <!--.card-->
            </div>

            </div>
            </div>
	
	
	
	
	

    <aside>
        <h1a> Product Description </h1a> 
        <p>These red mcIntosh apples are sold in a bag of 10.<span id="dots">...</span>
            <span id="more">They are produced locally in Quebec without any pesticides or GMO (genetically modified organism).</span>
        </p>
        <button onclick="myFunction()" id="myBtn" class="read">Read more</button>
    </aside>
    
    
    <script>
        let btn = document.querySelector('.mainBtn');
        let mbtn = document.querySelector('.minusBtn');
        let pbtn = document.querySelector('.plusBtn');
        
     btn.addEventListener("click",()=>{
      if(btn.innerText == 'ADD TO CART'){
      btn.innerText = 1;
      pbtn.style.display = 'inline-block';
      mbtn.style.display = 'inline-block';
      }
     })
     
      mbtn.addEventListener("click",()=>{
       if(btn.innerText == 40){
          pbtn.style.display = 'inline-block';
       }
      if(btn.innerText < 2){
        btn.innerText = 'ADD TO CART';
        pbtn.style.display = 'none';
        mbtn.style.display = 'none';
      }else{
       btn.innerText = btn.innerText - 1;
      }
     })
  
      pbtn.addEventListener("click",()=>{
         btn.innerText = +(btn.innerText) + + 1;
      if(btn.innerText == 40){
        pbtn.style.display = 'none';
      }
     })
 </script>

    
    <script>
function myFunction() {
  var dots = document.getElementById("dots");
  var moreText = document.getElementById("more");
  var btnText = document.getElementById("myBtn");

  if (dots.style.display === "none") {
    dots.style.display = "inline";
    btnText.innerHTML = "Read more"; 
    moreText.style.display = "none";
  } else {
    dots.style.display = "none";
    btnText.innerHTML = "Read less"; 
    moreText.style.display = "inline";
  }
}
</script>
<script src="../JavaScript/P3.js"></script>	
</body>
   </center>
</html>
